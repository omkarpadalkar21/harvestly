# App Directory Structure Documentation

## Overview

The `src/app` directory follows Next.js 15 App Router conventions with route groups for organized code splitting. This structure separates concerns between the main application, authentication, and admin interfaces.

## Directory Structure

```
src/app/
├── (app)/                    # Main application route group
│   ├── (auth)/              # Authentication routes
│   ├── (home)/              # Home and product pages
│   ├── layout.tsx           # Root layout for main app
│   ├── globals.css          # Global styles
│   └── favicon.ico          # App favicon
├── (payload)/               # Payload CMS admin route group
│   ├── admin/               # Admin interface
│   ├── api/                 # Payload API routes
│   ├── layout.tsx           # Payload admin layout
│   └── custom.scss          # Custom admin styles
├── api/                     # API routes
│   └── trpc/                # tRPC API endpoints
└── my-route/                # Custom route example
```

## Route Groups

### `(app)` - Main Application

The main application route group contains the user-facing interface of Harvestly.

#### Layout (`layout.tsx`)

- **Purpose**: Root layout for the main application
- **Key Features**:
  - Configures Google Fonts (DM Sans)
  - Sets up tRPC React Provider for type-safe API calls
  - Integrates NuqsAdapter for URL state management
  - Includes Toaster component for notifications
  - Defines metadata for SEO

#### Global Styles (`globals.css`)

- Contains global CSS styles and Tailwind CSS imports
- Defines custom CSS variables and base styles

### `(app)/(auth)` - Authentication Routes

Contains authentication-related pages for user sign-in and sign-up.

#### Structure:

```
(auth)/
├── sign-in/
│   └── page.tsx            # Sign-in page
└── sign-up/
    └── page.tsx            # Sign-up page
```

#### Features:

- User authentication forms
- Integration with Payload Auth
- Form validation and error handling

### `(app)/(home)` - Home and Product Pages

The main content area containing product listings, categories, and static pages.

#### Layout (`layout.tsx`)

- **Purpose**: Layout wrapper for home pages
- **Key Features**:
  - Prefetches categories data using tRPC
  - Includes Navbar and Footer components
  - Implements SearchFilters with Suspense boundary
  - Uses HydrationBoundary for SSR data hydration

#### Structure:

```
(home)/
├── [category]/             # Dynamic category routes
│   ├── [subcategory]/      # Dynamic subcategory routes
│   └── page.tsx           # Category listing page
├── about/
│   └── page.tsx           # About page
├── contact/
│   └── page.tsx           # Contact page
├── features/
│   └── page.tsx           # Features page
├── pricing/
│   └── page.tsx           # Pricing page
├── layout.tsx             # Home layout
└── page.tsx               # Homepage
```

#### Dynamic Routes:

- `[category]`: Displays products filtered by category
- `[category]/[subcategory]`: Shows products filtered by subcategory

### `(payload)` - Payload CMS Admin

The admin interface for content management, generated automatically by Payload CMS.

#### Layout (`layout.tsx`)

- **Purpose**: Payload CMS admin layout
- **Key Features**:
  - Auto-generated by Payload
  - Handles server functions for admin operations
  - Integrates with Payload's admin interface
  - Includes custom import map for admin components

#### Structure:

```
(payload)/
├── admin/
│   ├── [[...segments]]/    # Dynamic admin routes
│   │   ├── not-found.tsx   # Admin 404 page
│   │   └── page.tsx        # Admin main page
│   └── importMap.js        # Admin component imports
├── api/
│   ├── [...slug]/          # Payload API routes
│   ├── graphql/            # GraphQL endpoint
│   └── graphql-playground/ # GraphQL playground
├── layout.tsx              # Payload admin layout
└── custom.scss             # Custom admin styles
```

#### Admin Features:

- Content management for products, categories, and users
- Media file management
- User authentication and authorization
- GraphQL API access
- Custom admin styling

### `api` - API Routes

Contains API endpoints for the application.

#### Structure:

```
api/
└── trpc/
    └── [trpc]/
        └── route.ts        # tRPC API handler
```

#### Features:

- tRPC API endpoints for type-safe client-server communication
- Handles all API requests through tRPC router
- Supports both query and mutation operations

### `my-route` - Custom Route Example

A custom route example demonstrating how to create additional API endpoints.

#### Structure:

```
my-route/
└── route.ts               # Custom API route handler
```

## Key Components Integration

### Navigation Components

- **Navbar**: Main navigation bar with search and user menu
- **Footer**: Site footer with links and information

### Search and Filtering

- **SearchFilters**: Main search interface with category filtering
- **SearchFiltersLoading**: Loading state for search filters
- **Categories**: Category selection and navigation
- **SubcategoryMenu**: Subcategory filtering options

### Data Management

- **tRPC Integration**: Type-safe API calls throughout the app
- **React Query**: Server state management with caching
- **Hydration**: SSR data hydration for optimal performance

## Styling and UI

### CSS Framework

- **Tailwind CSS**: Utility-first CSS framework
- **shadcn/ui**: Pre-built component library
- **Custom Styles**: Global styles and component-specific styling

### Responsive Design

- Mobile-first approach
- Responsive navigation and layouts
- Adaptive search and filtering interfaces

## Performance Optimizations

### Data Fetching

- **Prefetching**: Categories data prefetched at layout level
- **Suspense Boundaries**: Loading states for async components
- **Hydration**: Efficient client-side hydration

### Code Splitting

- **Route Groups**: Logical separation of concerns
- **Dynamic Imports**: Lazy loading of components
- **Bundle Optimization**: Efficient code splitting

## Security Features

### Authentication

- **Payload Auth**: Secure user authentication
- **Protected Routes**: Admin interface protection
- **Session Management**: Secure session handling

### API Security

- **tRPC**: Type-safe API calls prevent injection attacks
- **Input Validation**: Server-side validation of all inputs
- **CORS**: Proper cross-origin request handling

## Development Workflow

### File Organization

- **Route Groups**: Logical separation of app sections
- **Component Co-location**: Components near their usage
- **Type Safety**: Full TypeScript integration

### Build Process

- **Next.js 15**: Latest App Router features
- **Payload CMS**: Headless CMS integration
- **tRPC**: End-to-end type safety

This structure provides a scalable, maintainable foundation for the Harvestly B2C platform with clear separation of concerns and optimal performance characteristics.
